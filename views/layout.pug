doctype html
html
  head
    //- title= `${location ? results : title + ' | ' + h.siteName}`
    title= message ? message : `${h.siteName} - ${title}`
    link(rel='stylesheet', href='/dist/style.css')
    link(rel="shortcut icon" type="image/png" href="/images/icons/favicon.png")
    link(rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans&display=swap")
    meta(name="viewport" content="width=device-width, initial-scale=1")
  body
    div#skip
      a(id="content" href="#maincontent") Skip to #{skip}
    nav.nav
      h2.offscreen Main navigation
      a.nav__logo(href="/" tabIndex="-1") Science Near Me
      button.hamburger.hamburger--collapse#menu
        span.hamburger-box
          span.hamburger-inner
      //- button#menu.nav__button.menu
      //-   span.menu-icon-open
      //-     != h.icon('menu')
      //-   span.menu-icon-close(style='display: none')
      //-     != h.icon('close')
      //-   span.offscreen Menu
      ul.nav__section
        each item in h.menu
          li.nav__item
            a.nav__link(href=item.slug class=(currentPath.startsWith(item.slug) ? 'nav__link--active' : '')) #{item.title}

        //- .search
        //-   label(for="search" class="offscreen") Search by event name:
        //-   input.search__input(type="text" id="search" name="search" placeholder="Search by event name...")
        //-   .search__results

        //- ul.nav__section
        if user
          each item in h.userMenu
            li.nav__item
              a.nav__link(href=item.slug class=(currentPath.startsWith(item.slug) ? 'nav__link--active' : '')) #{item.title}
          if user.admin
            each item in h.adminMenu
              li.nav__item
                a.nav__link(href=item.slug class=(currentPath.startsWith(item.slug) ? 'nav__link--active' : '')) #{item.title}
          li.nav__item: a.nav__link(href="/logout") Logout
          li.nav__item: a.nav__link(href="/account")
            img.avatar(src=user.gravatar + '&d=retro' alt="Account details")
        else
          li.nav__item.nav__item--right: a.nav__link(href="/register") Register
          li.nav__item.nav__item--right: a.nav__link(href="/login") Sign in

    block header
    block messages
      if locals.flashes
        .inner
          .flash-messages
            - const categories = Object.keys(locals.flashes)
            each category in categories
              each message in flashes[category]
                .flash(class=`flash--${category}`)
                  p.flash__text!= message
                  button.flash__remove(onClick="this.parentElement.remove()") &times;
    
    //- include about

    block content

    block footer

    block scripts
      script(src="https://cdn.tiny.cloud/1/2j0e390z4afzde1vmezs5gp43iqh04df9x0xygj082r4ujgy/tinymce/5/tinymce.min.js" referrerpolicy="origin")
      script.
        tinymce.init({
          selector: '#description',
          height: 500, 
          menubar: "edit format",
          menu: {
            format: { title: 'Format', items: 'bold italic undeline strikethrough superscript subscript | forecolor backcolor | removeformat' }
          },
          style_formats: [
            { title: 'Headings', items: [
              { title: 'Heading 2', format: 'h2' },
              { title: 'Heading 3', format: 'h3' },
              { title: 'Heading 4', format: 'h4' }
            ]},
            { title: 'Inline', items: [
              { title: 'Bold', format: 'bold' },
              { title: 'Italic', format: 'italic' },
              { title: 'Underline', format: 'underline' },
              { title: 'Strikethrough', format: 'strikethrough' },
              { title: 'Superscript', format: 'superscript' },
              { title: 'Subscript', format: 'subscript' }
            ]},
            { title: 'Blocks', items: [
              { title: 'Paragraph', format: 'p' },
              { title: 'Blockquote', format: 'blockquote' }
            ]}
          ]
        })
      script(src="https://developers.google.com/maps/documentation/javascript/examples/markerclusterer/markerclusterer.js")
      script(src=`https://maps.googleapis.com/maps/api/js?key=${process.env.MAP_KEY}&libraries=places`)
      script(src="/dist/App.bundle.js")
						
